> source("calmod.r")
> library(VGAM)
Loading required package: stats4
Loading required package: splines
> library(locfit)
locfit 1.5-9.1 	 2013-03-22
> POST <- scan(("posterior_G11spp_3+3m_UppMig1+10_mt21.48z1.2exo0.66_PiWthetaPinetTajddenomJWakeley"),nlines=500)
Read 118000 items
> POSTVEC <- matrix(POST, ncol=236, byrow=T)
> MZ_OBS <- scan(("obsSS_G11spp_HEADLESS.txt"),nlines=1)
Read 236 items
> OBS <- matrix(MZ_OBS,ncol=236,byrow=T)
> CR <- calmod(OBS[1,c(28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236)],POSTVEC[,1],POSTVEC[,c(28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236)],1.0,seq(1,len=500),F)

> CR$x2
              1         2
[1,] 0.06431966 0.9356803


> TDpolyRegMode <- (which.max(CR$x2))
> TDpolyRegMode
[1] 2


> 
> BFmigration_1 <- CR$x2[,1]/CR$x2[,2]
> BFmigration_1
         1 
0.06874106 


> BFmigration_10 <- CR$x2[,2]/CR$x2[,1]
> BFmigration_10
       2 
14.54735 

> 
> CR$x1
$fitted.values
[1] -2.677409

$se.fit
[1] 1.619822

$df
[1] 444

$sigma
[1] 1

